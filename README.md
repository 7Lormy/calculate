# Калькулятор с поддержкой скобок и RPN

## Название проекта
**Модульный калькулятор с использованием алгоритма Шунтирующего двора для обработки скобок и приоритетов операторов.**  

## Цель проекта
Создать **модульное приложение**, которое:

- Позволяет пользователю вводить арифметические выражения с числами, операторами и скобками.  
- Корректно обрабатывает приоритет операций и скобки.  
- Обеспечивает обработку ошибок и защиту от некорректного ввода.  
- Легко тестируется и расширяется за счёт модульной архитектуры.  

Проект позволяет изучить:

- Алгоритм **Шунтирующего двора**.  
- Преобразование инфиксных выражений в **RPN (постфиксная запись)**.  
- Работа с **модулями и исключениями** в Python.  
- Тестирование с использованием `pytest`.  

---

## Архитектура приложения

Приложение разделено на **три основных модуля**:

### 1. Модуль токенизации 
(tokenize.py)
Отвечает за разбиение выражения на числа, операторы и скобки.  

- Преобразует строку в список токенов.  
- Обрабатывает унарные + и -.  
- Проверяет ошибки типа:
  - два числа подряд без оператора;
  - недопустимые символы;
  - бинарные операции между числами

---

### 2. Модуль преобразования в RPN 
(
Polish.py
)

Использует алгоритм Шунтирующего двора:

- Проверяет ошибки типа:
  - пустые скобки. 
  - Несбалансированные скобки.


- Преобразует инфиксное выражение в постфиксное (RPN).  
- Учитывает приоритеты операторов:
1. Скобки ()  
2. Возведение в степень ** (правоассоциативное)  
3. Умножение, деление /, целочисленное деление //, остаток %  
4. Сложение и вычитание +, -
- Поддерживает **унарный минус**.  

---

### 3. Модуль вычисления RPN 
(
eval_polish.py
)

Вычисляет результат с использованием стека:

- Для каждого токена:
  - Если число → помещаем в output.  
  - Если оператор → кладем в stack, выталкиваем операторы с высшим или равным приоритетом в output
- Проверяет ошибки вычислений:
  - деление на ноль;  
  - операции // и % только для целых чисел;   
- Поддерживает числа с плавающей точкой и целые числа.  

---

### 4. Модуль ошибок (calc_errors.py)
Содержит кастомные исключения:
- TokenizationError - ошибка с неизвестным символом
- MultipleUnaryOperatorsError - несколько унарных операторов в начале выражения
- InvalidFloatFormatError - неверный формат числа типа Float
- EvaluationError - ошибка вычисления
- InsufficientOperandsError - ошибка недостаточности операндов
- FloatOperandError - ошибка при использовании чисел типа Float в целочисленном делении
- FloatOperandInModError - ошибка при использовании чисел типа Float в операции взятия остатка
- DivisionByZeroError - ошибка деления на ноль
- IntegerDivisionByZeroError - ошибка целочисленного деления на ноль
- ParsingError - ошибка парсинга
- TooManyOperatorsError - 3 и более операторов подряд между числами
- InvalidOperatorSequenceError - Неверная последовательность двух операторов между числами


## Поддерживаемые операции

- Сложение: +  
- Вычитание: -  
- Умножение: *  
- Деление: /  
- Целочисленное деление: // (только для целых чисел)  
- Остаток от деления: % (только для целых чисел)  
- Возведение в степень: **  
- Унарный плюс и минус: +, -     ($, ~)

> **Важно:** // и % работают только с целыми числами. Деление на ноль вызывает ошибку.

---

## Правила ввода выражений

- Скобки должны быть сбалансированы.  
- Числа не могут идти друг за другом без оператора.  
- Недопустимые комбинации операторов (например, ++ вне скобок) вызывают ошибку.  
- Можно использовать числа с плавающей точкой, например: 3.14, .5.  
- Пробелы не влияют на обработку выражения.  

## Инструкция по использованию

1. Запуск тестов:

test




2. Для выхода из программы используйте:

выход или exit


## Интересные кейсы и проверки

- Выражение с несколькими унарными знаками: 
-(-3)
- Деление на ноль: 
10 / 0
- Использование целочисленного деления с float: 
5.1 // 2
 → ошибка
- Две точки подряд: 
7..2 + 1
- Несбалансированные скобки: 
(2 + 3))


## Итоги проекта

- Освоен алгоритм Шунтирующего двора для работы со скобками.
- Создан модульный калькулятор с разделением на токенизацию, преобразование в RPN и вычисление.
- Реализована полная обработка ошибок для некорректных выражений.
- Освоено тестирование с помощью pytest.
- Улучшены навыки чистой архитектуры, модульности и расширяемости кода.```